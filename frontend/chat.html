<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chat - Bubble</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <header class="bubble-header">
    <div class="header-left">
      <img src="assets/logo-bubble.svg" alt="Logo Bubble" style="height:40px;vertical-align:middle;margin-right:10px;">
      <span class="bubble-title">Bubble</span>
    </div>
    <nav class="header-right" id="header-nav">
      <a href="cadastro.html" class="header-link" id="link-cadastro">Cadastro</a>
      <a href="login.html" class="header-link" id="link-login">Login</a>
      <a href="conhecer.html" class="header-link" id="link-conhecer">Conhecer Pessoas</a>
      <a href="perfil.html" class="header-link" id="link-perfil">Perfil</a>
      <a href="chat.html" class="header-link" id="link-chat">Chat</a>
    </nav>
  </header>
  <main>
    <section class="chat-section" style="display:flex;gap:32px;">
      <aside class="chat-users" style="width:220px;">
        <h3>Pessoas que você curtiu</h3>
        <ul class="chat-user-list" id="chat-user-list">
          <li class="chat-user">Carregando...</li>
        </ul>
      </aside>
      <div class="chat-area" style="flex:1;">
        <h3 id="chat-title">Chat</h3>
        <div class="chat-history" id="chat-history" style="height:300px;overflow-y:auto;border:1px solid #ccc;padding:10px;margin-bottom:10px;">
        </div>
        <form class="chat-form" id="chat-form" style="display:flex;gap:8px;">
          <input type="text" id="chat-input" placeholder="Digite sua mensagem..." style="flex:1;">
          <button type="submit">Enviar</button>
        </form>
      </div>
    </section>
  </main>
  <script type="module" src="js/header.js"></script>
  <script type="module">
    import { getMe } from './js/api.js';
    async function renderChat() {
      const token = localStorage.getItem('bubble_token');
      if (!token) {
        document.getElementById('chat-user-list').innerHTML = '<li>Faça login para ver suas conversas.</li>';
        document.getElementById('chat-title').textContent = 'Chat';
        document.getElementById('chat-history').innerHTML = '';
        document.getElementById('chat-form').style.display = 'none';
        return;
      }
      // Aqui você pode buscar conversas reais do backend e preencher a lista e histórico
      // Exemplo fictício:
      document.getElementById('chat-user-list').innerHTML = '<li class="chat-user">Pessoa 1</li><li class="chat-user">Pessoa 2</li>';
      document.getElementById('chat-title').textContent = 'Chat com Pessoa 1';
      document.getElementById('chat-history').innerHTML = '<div class="chat-message"><b>Você:</b> Olá!</div><div class="chat-message"><b>Pessoa 1:</b> Oi, tudo bem?</div>';
      document.getElementById('chat-form').style.display = '';
    }
    renderChat();
    window.addEventListener('storage', renderChat);
  </script>
</body>
</html>
